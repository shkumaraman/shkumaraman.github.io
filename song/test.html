<input type="text" id="searchQuery" placeholder="Search songs..." />
<button onclick="searchSongs()">Search</button>

<ul id="searchResults"></ul>

<script>
async function searchSongs() {
  const query = document.getElementById('searchQuery').value;
  if (!query) return;

  // 1️⃣ Search
  const response = await fetch(`https://jiosaavn-ygm1.onrender.com/result/?query=${encodeURIComponent(query)}`);
  const data = await response.json();

  const results = data.songs || [];
  const list = document.getElementById('searchResults');
  list.innerHTML = '';

  results.forEach(song => {
    const listItem = document.createElement('li');
    listItem.textContent = song.song;
    listItem.style.cursor = "pointer";
    listItem.onclick = () => playSong(song.id); // song ID se play karenge
    list.appendChild(listItem);
  });
}

async function playSong(songId) {
  // 2️⃣ Get song details for playable URL
  const res = await fetch(`https://jiosaavn-ygm1.onrender.com/song/?query=${songId}`);
  const data = await res.json();

  // 'songId' key in returned JSON might be nested, check structure
  const mediaUrl = data[songId]?.media_url || data[songId]?.320kbps || data[songId]?.more_info?.encrypted_media_url;

  if (!mediaUrl) {
    alert("Playable media URL not found for this song.");
    return;
  }

  const audio = new Audio(mediaUrl);
  audio.play();
  alert(`Now playing: ${data[songId]?.song || "Unknown"}`);
}
</script>
