---
layout: default
title: "Chat Rooms"
description: "Join free group chat rooms. Connect with general, singles, dating groups, and communities in real-time chat rooms."
---

<style>
:root {
  --dark-bg: #121212;
  --dark-header-bg: #181818;
  --dark-header-border: #2a2a2a;
  --dark-text: #fff;
  --dark-secondary-text: #aaa;
  --dark-icon-color: #ccc;
  --dark-icon-hover-bg: rgba(255,255,255,0.1);
  --dark-card-bg: #1e1e1e;
  --dark-card-border: #333;
  --dark-modal-bg: #1e1e1e;
  --dark-input-bg: #333;
  
  --light-bg: #f5f5f5;
  --light-header-bg: #ffffff;
  --light-header-border: #e0e0e0;
  --light-text: #333;
  --light-secondary-text: #666;
  --light-icon-color: #666;
  --light-icon-hover-bg: rgba(0,0,0,0.05);
  --light-card-bg: #fff;
  --light-card-border: #ddd;
  --light-modal-bg: #fff;
  --light-input-bg: #e0e0e0;
}

* {
  box-sizing: border-box;
}

body {
  margin: 0;
  padding: 0;
  font-family: 'Segoe UI', sans-serif;
  background: var(--dark-bg);
  color: var(--dark-text);
  transition: background 0.3s, color 0.3s;
}

body.light-mode {
  background: var(--light-bg);
  color: var(--light-text);
}

.app-header {
  position: fixed !important;
  top: 0;
  left: 0;
  width: 100%;
  height: 50px;
  background: var(--dark-header-bg);
  padding: 8px 15px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 15px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.4);
  border-bottom: 1px solid var(--dark-header-border);
  z-index: 10000;
}

.light-mode .app-header {
  background: var(--light-header-bg);
  border-bottom: 1px solid var(--light-header-border);
}

.header-left, .header-right {
  display: flex;
  align-items: center;
  gap: 10px;
}

.logo {
  height: 40px;
  width: 40px;
  border-radius: 10px;
}

.app-title {
  font-size: 1em;
  color: var(--dark-text);
  margin: 0;
}

.light-mode .app-title {
  color: var(--light-text);
}

.header-toggle {
  background: none;
  border: none;
  color: var(--dark-icon-color);
  font-size: 1.1em;
  cursor: pointer;
  width: 32px;
  height: 32px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  transition: all 0.3s;
}

.header-toggle:hover {
  background: var(--dark-icon-hover-bg);
}

.light-mode .header-toggle {
  color: var(--light-icon-color);
}

.light-mode .header-toggle:hover {
  background: var(--light-icon-hover-bg);
}

.tab-container {
  margin-top: 60px;
  margin-bottom: 20px;
}

.tabs {
  display: flex;
  gap: 10px;
  border-bottom: 1px solid var(--dark-card-border);
  padding-bottom: 10px;
  margin-bottom: 20px;
}

.light-mode .tabs {
  border-bottom-color: var(--light-card-border);
}

.tab-btn {
  background: none;
  border: none;
  color: var(--dark-secondary-text);
  padding: 10px 20px;
  font-size: 1.1em;
  cursor: pointer;
  border-radius: 20px;
  transition: all 0.3s;
  width: 50%;
}

.light-mode .tab-btn {
  color: var(--light-secondary-text);
}

.tab-btn.active {
  background: var(--dark-card-bg);
  color: var(--dark-text);
}

.light-mode .tab-btn.active {
  background: var(--light-card-bg);
  color: var(--light-text);
}

.tab-content {
  display: none;
}

.tab-content.active {
  display: block;
}

main {
  padding: 15px;
  max-width: 1200px;
  margin: 0 auto;
  width: 100%;
}

.rooms-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 16px;
}

@media (max-width: 768px) {
  .rooms-grid {
    grid-template-columns: 1fr;
    gap: 14px;
  }
}

.room-card {
  background: var(--dark-card-bg);
  border: 1px solid var(--dark-card-border);
  border-radius: 10px;
  padding: 16px;
  transition: transform 0.2s, box-shadow 0.2s;
  display: flex;
  flex-direction: column;
}

.light-mode .room-card {
  background: var(--light-card-bg);
  border: 1px solid var(--light-card-border);
}

.room-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

.room-header {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  margin-bottom: 12px;
}

.room-image {
  width: 50px;
  height: 50px;
  border-radius: 8px;
  object-fit: cover;
  flex-shrink: 0;
}

.room-info {
  flex: 1;
}

.room-title {
  font-size: 1.3em;
  margin: 0 0 8px 0;
  color: var(--dark-text);
}

.light-mode .room-title {
  color: var(--light-text);
}

.room-description {
  color: var(--dark-secondary-text);
  margin: 0 0 16px 0;
  line-height: 1.4;
  font-size: 0.95em;
}

.light-mode .room-description {
  color: var(--light-secondary-text);
}

.room-actions {
  display: flex;
  gap: 8px;
  margin-top: auto;
}

.btn {
  padding: 8px 12px;
  border: none;
  border-radius: 6px;
  font-size: 0.9em;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 6px;
  transition: all 0.2s;
  font-weight: 500;
  text-decoration: none;
  height: 36px;
}

.btn.btn-primary {
  background-color: #25D366 !important;
  color: #fff;
  flex: 1;
}

.btn.btn-primary:hover,
.btn.btn-primary:focus,
.btn.btn-primary:active {
  background-color: #1ebe5d !important;
  color: #fff !important;
}

.btn-secondary {
  background: var(--dark-card-border);
  color: var(--dark-text);
  width: 36px;
  padding: 8px 0;
}

.btn-secondary:hover {
  background: var(--dark-icon-hover-bg);
}

.light-mode .btn-secondary {
  background: var(--light-card-border);
  color: var(--light-text);
}

.light-mode .btn-secondary:hover {
  background: var(--light-icon-hover-bg);
}

.btn-danger {
  background: #dc3545;
  color: #fff;
  width: 36px;
  padding: 8px 0;
}

.btn-danger:hover {
  background: #c82333;
}

.create-room-form {
  background: var(--dark-card-bg);
  border: 1px solid var(--dark-card-border);
  border-radius: 10px;
  padding: 25px;
  max-width: 600px;
  margin: 20px auto;
}

.light-mode .create-room-form {
  background: var(--light-card-bg);
  border: 1px solid var(--light-card-border);
}

.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  margin-bottom: 8px;
  font-weight: 500;
}

.form-control {
  width: 100%;
  padding: 10px 12px;
  border-radius: 6px;
  border: none;
  background: var(--dark-input-bg);
  color: var(--dark-text);
  font-size: 0.95em;
}

.light-mode .form-control {
  background: var(--light-input-bg);
  color: var(--light-text);
}

.form-control:focus {
  outline: 2px solid #25D366;
}

.room-badge {
  display: inline-block;
  padding: 2px 6px;
  border-radius: 10px;
  font-size: 0.7em;
  background: #ffc107;
  color: #000;
  margin-left: 6px;
}

.password-protected {
  border-left: 3px solid #ffc107;
}

@media (max-width: 600px) {
  .room-card {
    padding: 14px;
  }
  
  .room-header {
    gap: 10px;
  }
  
  .room-image {
    width: 45px;
    height: 45px;
  }
  
  .room-title {
    font-size: 1.2em;
  }
  
  .room-description {
    font-size: 0.9em;
    line-height: 1.3;
  }
  
  .btn {
    padding: 6px 10px;
    font-size: 0.85em;
    height: 34px;
  }
  
  .btn-secondary, .btn-danger {
    width: 34px;
    padding: 6px 0;
  }
  
  .create-room-form {
    padding: 20px;
  }
}

.chatrooms-password-modal {
  display: none;
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0,0,0,0.7);
  z-index: 20000;
  align-items: center;
  justify-content: center;
}

.chatrooms-modal-content {
  background: var(--dark-modal-bg);
  border-radius: 10px;
  padding: 25px;
  max-width: 400px;
  width: 90%;
}

.light-mode .chatrooms-modal-content {
  background: var(--light-modal-bg);
}

.chatrooms-modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.chatrooms-modal-title {
  margin: 0;
  font-size: 1.3em;
}

.chatrooms-close-modal {
  background: none;
  border: none;
  color: var(--dark-secondary-text);
  font-size: 1.5em;
  cursor: pointer;
}

.light-mode .chatrooms-close-modal {
  color: var(--light-secondary-text);
}

.chatrooms-modal-footer {
  margin-top: 20px;
  display: flex;
  gap: 10px;
  justify-content: flex-end;
}
</style>

<header class="app-header">
  <div class="header-left">
    <button class="menu-btn" onclick="toggleMenu()">&#9776;</button>
    <img src="logo.png" alt="Chat Rooms Logo" class="logo">
    <h1 class="app-title">Chat Rooms</h1>
  </div>
  <div class="header-right">
    <button class="header-toggle" onclick="openPreferencesModal()" title="Edit Interest">
      <i class="fas fa-pencil-alt"></i>
    </button>
    <button class="header-toggle" id="themeToggle" title="Toggle Dark/Light Mode">
      <i class="fas fa-moon"></i>
    </button>
  </div>
</header>

<main>
  <div class="tab-container">
    <div class="tabs">
      <button class="tab-btn active" onclick="switchTab('rooms', this)">Rooms</button>
      <button class="tab-btn" onclick="switchTab('create', this)">Create</button>
    </div>

    <div id="rooms-tab" class="tab-content active">
      <h2 style="font-size: 1.2em; margin-bottom: 15px;">Featured Rooms</h2>
      <div class="rooms-grid" id="permanentRooms"></div>
      
      <h2 style="font-size: 1.2em; margin-bottom: 15px; margin-top: 25px;">Community Rooms</h2>
      <div id="dynamicRooms" class="rooms-grid"></div>
    </div>

    <div id="create-tab" class="tab-content">
      <div class="create-room-form">
        <h2 style="margin-top: 0; margin-bottom: 20px; font-size: 1.3em;">Create New Room</h2>
        
        <div class="form-group">
          <label for="roomTitle">Room Title *</label>
          <input type="text" id="roomTitle" class="form-control" placeholder="e.g., Gaming Lovers, Tech Talk" required>
        </div>
        
        <div class="form-group">
          <label for="roomDescription">Description</label>
          <textarea id="roomDescription" class="form-control" rows="3" placeholder="What's this room about? (Optional)"></textarea>
        </div>
        
        <div class="form-group">
          <label for="roomPassword">Password</label>
          <input type="password" id="roomPassword" class="form-control" placeholder="Leave empty for public room">
        </div>
        
        <div style="display: flex; gap: 10px;">
          <button class="btn btn-primary" style="flex: 1;" onclick="createNewRoom()">
            <i class="fas fa-plus-circle"></i>
            Create
          </button>
          <button class="btn btn-secondary" onclick="clearCreateForm()">
            <i class="fas fa-undo"></i>
          </button>
        </div>
      </div>
    </div>
  </div>

  <ins class="adsbygoogle"
       style="display:block; margin-top: 30px;"
       data-ad-client="ca-pub-7059052735946479"
       data-ad-slot="8592327962"
       data-ad-format="auto"
       data-full-width-responsive="true"></ins>
  <script>
       (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

  <div id="chatroomsPasswordModal" class="chatrooms-password-modal">
    <div class="chatrooms-modal-content">
      <div class="chatrooms-modal-header">
        <h3 class="chatrooms-modal-title">Password Required</h3>
        <button class="chatrooms-close-modal" onclick="closeChatroomsPasswordModal()">&times;</button>
      </div>
      <div class="form-group">
        <label for="chatroomsRoomPasswordInput">Enter Room Password</label>
        <input type="password" id="chatroomsRoomPasswordInput" class="form-control" placeholder="Password">
      </div>
      <div class="chatrooms-modal-footer">
        <button class="btn btn-secondary" onclick="closeChatroomsPasswordModal()">Cancel</button>
        <button class="btn btn-primary" onclick="verifyChatroomsPassword()">Join</button>
      </div>
    </div>
  </div>
</main>

{% include menu.html %}
{% include scripts.html %}

<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<script>
const firebaseConfig = {
  databaseURL: "https://talkrush-76259-default-rtdb.asia-southeast1.firebasedatabase.app/"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

let pendingChatroomsRoomId = null;
const defaultChatroomsImage = '/assets/chat-default.jpg';

const permanentChatroomsRooms = [
  {
    id: 'general',
    title: 'General Chat Room',
    description: 'Meet and chat with people from around the world. Make new friends and have casual conversations.',
    image: defaultChatroomsImage
  },
  {
    id: 'dating',
    title: 'Dating Chat Room',
    description: 'A cozy space for dating-minded individuals to connect, flirt, and find potential partners.',
    image: defaultChatroomsImage
  },
  {
    id: 'singles',
    title: 'Singles Chat Room',
    description: 'Connect with other singles looking for friendship, dating, or meaningful conversations.',
    image: defaultChatroomsImage
  }
];

document.addEventListener('DOMContentLoaded', function() {
  loadPermanentChatroomsRooms();
  loadDynamicChatroomsRooms();
  
  db.ref('groups').on('child_added', function(snapshot) {
    const roomId = snapshot.key;
    if (!isPermanentChatroomsRoom(roomId)) {
      loadDynamicChatroomsRooms();
    }
  });
  
  db.ref('groups').on('child_removed', function(snapshot) {
    loadDynamicChatroomsRooms();
  });
});

function isPermanentChatroomsRoom(roomId) {
  return ['general', 'dating', 'singles'].includes(roomId);
}

function loadPermanentChatroomsRooms() {
  const container = document.getElementById('permanentRooms');
  container.innerHTML = '';
  
  permanentChatroomsRooms.forEach(room => {
    container.appendChild(createChatroomsRoomCard(room, true));
  });
}

function loadDynamicChatroomsRooms() {
  db.ref('groups').once('value', function(snapshot) {
    const rooms = [];
    
    snapshot.forEach(function(childSnapshot) {
      const roomId = childSnapshot.key;
      
      if (!isPermanentChatroomsRoom(roomId)) {
        let roomInfo = {
          id: roomId,
          title: formatChatroomsRoomTitle(roomId),
          description: 'Join this community room!',
          hasPassword: false,
          timestamp: Date.now()
        };
        
        rooms.push(roomInfo);
      }
    });
    
    const shuffledRooms = shuffleChatroomsArray(rooms);
    
    const container = document.getElementById('dynamicRooms');
    container.innerHTML = '';
    
    if (shuffledRooms.length === 0) {
      container.innerHTML = '<p style="grid-column: 1/-1; text-align: center; color: var(--dark-secondary-text); padding: 30px;">No community rooms yet. Create one!</p>';
    } else {
      shuffledRooms.forEach(room => {
        db.ref(`roomPasswords/${room.id}`).once('value', function(pwSnapshot) {
          room.hasPassword = pwSnapshot.exists();
          container.appendChild(createChatroomsRoomCard(room, false));
        });
      });
    }
  });
}

function formatChatroomsRoomTitle(roomId) {
  return roomId.split('-').map(word => 
    word.charAt(0).toUpperCase() + word.slice(1)
  ).join(' ');
}

function shuffleChatroomsArray(array) {
  const shuffled = [...array];
  for (let i = shuffled.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
  }
  return shuffled;
}

function createChatroomsRoomCard(room, isPermanent = false) {
  const card = document.createElement('div');
  card.className = 'room-card' + (room.hasPassword || room.password ? ' password-protected' : '');
  
  const hasPassword = room.hasPassword || room.password;
  
  card.innerHTML = `
    <div class="room-header">
      <img src="${defaultChatroomsImage}" alt="${room.title}" class="room-image" onerror="this.src='/assets/chat-default.jpg'">
      <div class="room-info">
        <h2 class="room-title">
          ${room.title}
          ${hasPassword ? '<span class="room-badge">ðŸ”’</span>' : ''}
        </h2>
        <p class="room-description">${room.description || 'Join the conversation!'}</p>
      </div>
    </div>
    <div class="room-actions">
      <a href="javascript:void(0)" onclick="joinChatroomsRoom('${room.id}', ${hasPassword})" class="btn btn-primary">
        <i class="fas fa-sign-in-alt"></i>
        Join
      </a>
      <button class="btn btn-secondary" onclick="copyChatroomsRoomLink('${room.id}')" title="Copy Link">
        <i class="fas fa-link"></i>
      </button>
      ${!isPermanent ? `
        <button class="btn btn-danger" onclick="deleteChatroomsRoom('${room.id}')" title="Delete Room">
          <i class="fas fa-trash"></i>
        </button>
      ` : ''}
    </div>
  `;
  
  return card;
}

function createNewRoom() {
  const title = document.getElementById('roomTitle').value.trim();
  const description = document.getElementById('roomDescription').value.trim();
  const password = document.getElementById('roomPassword').value.trim();
  
  if (!title) {
    alert('Please enter a room title');
    return;
  }
  
  const roomId = title.toLowerCase()
    .replace(/[^a-z0-9]+/g, '-')
    .replace(/^-|-$/g, '');
  
  if (!roomId) {
    alert('Invalid room title');
    return;
  }
  
  db.ref(`groups/${roomId}`).once('value', function(snapshot) {
    if (snapshot.exists() || isPermanentChatroomsRoom(roomId)) {
      alert('A room with this name already exists. Please choose a different title.');
      return;
    }
    
    const initialMessage = {
      text: `ðŸŽ‰ Room created! Welcome to ${title}!`,
      timestamp: Date.now(),
      nickname: 'System',
      type: 'text'
    };
    
    db.ref(`groups/${roomId}/messages`).push().set(initialMessage)
      .then(() => {
        if (password) {
          return db.ref(`roomPasswords/${roomId}`).set(password);
        }
      })
      .then(() => {
        clearCreateForm();
        switchTab('rooms', document.querySelector('.tab-btn'));
        alert('Room created successfully!');
      })
      .catch(error => {
        console.error('Error creating room:', error);
        alert('Failed to create room. Please try again.');
      });
  });
}

function clearCreateForm() {
  document.getElementById('roomTitle').value = '';
  document.getElementById('roomDescription').value = '';
  document.getElementById('roomPassword').value = '';
}

function joinChatroomsRoom(roomId, hasPassword) {
  if (hasPassword) {
    pendingChatroomsRoomId = roomId;
    document.getElementById('chatroomsPasswordModal').style.display = 'flex';
  } else {
    if (roomId === 'general') {
      window.location.href = '/chat/group.html';
    } else {
      window.location.href = `/chat/group.html?group=${roomId}`;
    }
  }
}

function verifyChatroomsPassword() {
  const password = document.getElementById('chatroomsRoomPasswordInput').value;
  
  if (!pendingChatroomsRoomId) {
    closeChatroomsPasswordModal();
    return;
  }
  
  db.ref(`roomPasswords/${pendingChatroomsRoomId}`).once('value', function(snapshot) {
    const storedPassword = snapshot.val();
    
    if (storedPassword && storedPassword === password) {
      closeChatroomsPasswordModal();
      window.location.href = `/chat/group.html?group=${pendingChatroomsRoomId}`;
    } else {
      alert('Incorrect password!');
    }
  });
}

function closeChatroomsPasswordModal() {
  document.getElementById('chatroomsPasswordModal').style.display = 'none';
  document.getElementById('chatroomsRoomPasswordInput').value = '';
  pendingChatroomsRoomId = null;
}

function deleteChatroomsRoom(roomId) {
  if (confirm('Delete this room? This cannot be undone.')) {
    db.ref(`groups/${roomId}`).remove()
      .then(() => {
        return db.ref(`roomPasswords/${roomId}`).remove();
      })
      .then(() => {
        alert('Room deleted');
      })
      .catch(error => {
        console.error('Error deleting room:', error);
        alert('Failed to delete room');
      });
  }
}

function copyChatroomsRoomLink(roomId) {
  let url;
  
  if (roomId === 'general') {
    url = window.location.origin + '/chat/group.html';
  } else {
    url = window.location.origin + `/chat/group.html?group=${roomId}`;
  }
  
  navigator.clipboard.writeText(url)
    .then(() => {
      alert('Link copied!');
    })
    .catch(() => {
      prompt('Copy this link:', url);
    });
}

function switchTab(tabName, btn) {
  document.querySelectorAll('.tab-btn').forEach(btn => {
    btn.classList.remove('active');
  });
  btn.classList.add('active');
  
  document.getElementById('rooms-tab').classList.remove('active');
  document.getElementById('create-tab').classList.remove('active');
  
  if (tabName === 'rooms') {
    document.getElementById('rooms-tab').classList.add('active');
  } else {
    document.getElementById('create-tab').classList.add('active');
  }
}

window.onclick = function(event) {
  const modal = document.getElementById('chatroomsPasswordModal');
  if (event.target === modal) {
    closeChatroomsPasswordModal();
  }
}
</script>
