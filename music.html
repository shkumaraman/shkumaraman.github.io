<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>YT Music Player</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f9;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    h1 { color: #333; }
    #results {
      margin-top: 20px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 15px;
      width: 100%;
      max-width: 900px;
    }
    .card {
      background: white;
      border-radius: 10px;
      padding: 10px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      text-align: center;
    }
    .card img {
      width: 100%;
      border-radius: 8px;
    }
    audio {
      margin-top: 10px;
      width: 100%;
    }
  </style>
</head>
<body>
  <h1>ðŸŽµ My YT Music Player</h1>
  <input type="text" id="searchBox" placeholder="Search songs..." />
  <button onclick="searchSongs()">Search</button>

  <div id="results"></div>

  <script>
    const API_BASE = "https://shkumaraman-github-io.onrender.com";

    async function searchSongs() {
      const query = document.getElementById("searchBox").value;
      if (!query) return alert("Enter a search term");

      const res = await fetch(`${API_BASE}/search?q=${query}`);
      const data = await res.json();

      const resultsDiv = document.getElementById("results");
      resultsDiv.innerHTML = "";

      data.forEach(item => {
        if (item.videoId) {
          const card = document.createElement("div");
          card.className = "card";

          card.innerHTML = `
            <img src="${item.thumbnails[0].url}" alt="thumbnail" />
            <h3>${item.name}</h3>
            <p>${item.artist?.name || "Unknown Artist"}</p>
            <button onclick="playSong('${item.videoId}')">Play</button>
            <div id="player-${item.videoId}"></div>
          `;

          resultsDiv.appendChild(card);
        }
      });
    }

    async function playSong(videoId) {
      const res = await fetch(`${API_BASE}/song/${videoId}`);
      const data = await res.json();

      const playerDiv = document.getElementById(`player-${videoId}`);
      playerDiv.innerHTML = `
        <audio controls autoplay>
          <source src="${data.formats[0].url}" type="audio/mp4">
          Your browser does not support audio.
        </audio>
      `;
    }
  </script>
</body>
</html>
