<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Comment System</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }

    #comments-container {
      margin-top: 20px;
    }

    .comment {
      border: 1px solid #ccc;
      margin-bottom: 10px;
      padding: 10px;
    }

    .comment textarea {
      width: 100%;
      margin-bottom: 5px;
    }

    .comment .user {
      font-weight: bold;
    }

    .comment .timestamp {
      color: #888;
      font-size: 12px;
    }

    #comment-form {
      margin-top: 20px;
    }
  </style>
</head>
<body>

<div id="comments-container"></div>

<!-- Form to add comments -->
<div id="comment-form">
  <textarea id="comment-text" placeholder="Write a comment..."></textarea>
  <button onclick="postComment()">Post</button>
</div>

<script src="https://www.gstatic.com/firebasejs/9.6.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.2/firebase-firestore.js"></script>
<script>
  const firebaseConfig = {
    apiKey: 'YOUR_API_KEY',
    authDomain: 'YOUR_AUTH_DOMAIN',
    projectId: 'YOUR_PROJECT_ID',
    storageBucket: 'YOUR_STORAGE_BUCKET',
    messagingSenderId: 'YOUR_MESSAGING_SENDER_ID',
    appId: 'YOUR_APP_ID'
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.firestore();

  function postComment() {
    const commentText = document.getElementById('comment-text').value;

    if (commentText.trim() !== '') {
      const comment = {
        text: commentText,
        user: 'User#' + generateUserId(), // Replace with actual user authentication
        timestamp: new Date()
      };

      db.collection('comments').add(comment)
        .then(() => {
          document.getElementById('comment-text').value = '';
          loadComments();
        })
        .catch(error => console.error('Error adding comment: ', error));
    }
  }

  function generateUserId() {
    // Replace this with your logic for generating user IDs
    return Math.floor(Math.random() * 1000);
  }

  function loadComments() {
    const commentsContainer = document.getElementById('comments-container');
    commentsContainer.innerHTML = '';

    db.collection('comments').orderBy('timestamp', 'desc').get()
      .then(querySnapshot => {
        querySnapshot.forEach(doc => {
          const commentData = doc.data();
          const commentElement = createCommentElement(commentData);
          commentsContainer.appendChild(commentElement);
        });
      })
      .catch(error => console.error('Error getting comments: ', error));
  }

  function createCommentElement(commentData) {
    const commentDiv = document.createElement('div');
    commentDiv.className = 'comment';

    const userSpan = document.createElement('span');
    userSpan.className = 'user';
    userSpan.textContent = commentData.user;

    const timestampSpan = document.createElement('span');
    timestampSpan.className = 'timestamp';
    timestampSpan.textContent = commentData.timestamp.toDate().toLocaleString();

    const textParagraph = document.createElement('p');
    textParagraph.textContent = commentData.text;

    commentDiv.appendChild(userSpan);
    commentDiv.appendChild(timestampSpan);
    commentDiv.appendChild(textParagraph);

    return commentDiv;
  }

  // Initial load
  loadComments();
</script>

</body>
</html>
