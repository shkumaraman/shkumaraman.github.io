<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Community</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        body {
            font-family: 'Helvetica Neue', sans-serif;
            background-color: #f5f8fa;
            margin: 10px;
        }

        #app {
            max-width: 600px;
            margin: auto;
        }

        .search-bar,
        .ask-question {
            display: flex;
            justify-content: space-between;
            background-color: #ffffff;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #e1e8ed;
            margin-bottom: 10px;
            overflow-wrap: break-word;
        }

        .question,
        .answer,
        .reply {
            font-size: 18px;
            font-weight: bold;
            margin-top: 25px;
            background-color: #ffffff;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #e1e8ed;
            color: #14171a;
            position: relative;
            overflow-wrap: break-word;
            word-wrap: break-word;
        }

        .input-container {
            display: flex;
            align-items: flex-end;
            margin-top: 10px;
        }

        textarea {
            width: 70%;
            padding: 8px;
            margin-right: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            overflow-wrap: break-word;
        }

        button {
            background-color: #1da1f2;
            color: #ffffff;
            border: none;
            height: 50px;
            width: 100px;
            border-radius: 4px;
            cursor: pointer;
        }

        .edit-options {
            position: absolute;
            top: 5px;
            right: 10px;
            display: flex;
            align-items: center;
        }

        .edit-options button {
            margin-left: 2px;
            height: 30px;
            width: 30px;
            opacity: 50%;
        }

        .url-preview {
            max-width: 100%;
            height: auto;
            margin-top: 5px;
            margin-bottom: 5px;
            overflow-wrap: break-word;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="search-bar">
            <textarea id="searchQuery" placeholder="Search Questions..." class="search-textarea"></textarea>
            <button onclick="searchQuestions()">Search</button>
        </div>
        <div class="ask-question">
            <textarea id="newQuestion" placeholder="Ask a Question..."></textarea>
            <button onclick="submitQuestion()">Ask</button>
        </div>
        <div id="questionsAndAnswers"></div>
    </div>

    <script>
        let questionsAndAnswers = [];

        function submitQuestion() {
            const questionTextarea = document.getElementById('newQuestion');
            const question = questionTextarea.value.trim();
            if (question !== '') {
                questionsAndAnswers.push({ content: question, answers: [] });
                questionTextarea.value = '';
                saveData();
            }
        }

        function submitAnswer(qIndex) {
            const answerTextarea = document.getElementById(`newAnswer${qIndex}`);
            const answer = answerTextarea.value.trim();
            if (answer !== '') {
                questionsAndAnswers[qIndex].answers.push({ content: answer, replies: [] });
                answerTextarea.value = '';
                saveData();
            }
        }

        function submitReply(qIndex, aIndex) {
            const replyTextarea = document.getElementById(`newReply${qIndex}_${aIndex}`);
            const reply = replyTextarea.value.trim();
            if (reply !== '') {
                questionsAndAnswers[qIndex].answers[aIndex].replies.push({ content: reply });
                replyTextarea.value = '';
                saveData();
            }
        }

        function editQuestion(qIndex) {
            const newContent = prompt('Edit your question:', questionsAndAnswers[qIndex].content);
            if (newContent !== null) {
                questionsAndAnswers[qIndex].content = newContent;
                saveData();
            }
        }

        function deleteQuestion(qIndex) {
            if (confirm('Are you sure you want to delete this question?')) {
                questionsAndAnswers.splice(qIndex, 1);
                saveData();
            }
        }

        function editAnswer(qIndex, aIndex) {
            const newContent = prompt('Edit your answer:', questionsAndAnswers[qIndex].answers[aIndex].content);
            if (newContent !== null) {
                questionsAndAnswers[qIndex].answers[aIndex].content = newContent;
                saveData();
            }
        }

        function deleteAnswer(qIndex, aIndex) {
            if (confirm('Are you sure you want to delete this answer?')) {
                questionsAndAnswers[qIndex].answers.splice(aIndex, 1);
                saveData();
            }
        }

        function editReply(qIndex, aIndex, rIndex) {
            const newContent = prompt('Edit your reply:', questionsAndAnswers[qIndex].answers[aIndex].replies[rIndex].content);
            if (newContent !== null) {
                questionsAndAnswers[qIndex].answers[aIndex].replies[rIndex].content = newContent;
                saveData();
            }
        }

        function deleteReply(qIndex, aIndex, rIndex) {
            if (confirm('Are you sure you want to delete this reply?')) {
                questionsAndAnswers[qIndex].answers[aIndex].replies.splice(rIndex, 1);
                saveData();
            }
        }

        function searchQuestions() {
            const searchQuery = document.getElementById('searchQuery').value.toLowerCase();
            const filteredQuestions = questionsAndAnswers.filter(qa => qa.content.toLowerCase().includes(searchQuery));
            displayQuestionsAndAnswers(filteredQuestions);
        }

        function saveData() {
            // Use your preferred method to save data (e.g., local storage, database)
            // For demonstration purposes, storing in local storage
            localStorage.setItem('questionsAndAnswers', JSON.stringify(questionsAndAnswers));
            fetchData();
        }

        function fetchData() {
            // Use your preferred method to fetch data (e.g., local storage, database)
            // For demonstration purposes, retrieving from local storage
            const storedData = localStorage.getItem('questionsAndAnswers');
            if (storedData) {
                questionsAndAnswers = JSON.parse(storedData);
            }
            displayQuestionsAndAnswers(questionsAndAnswers);
        }

        function displayQuestionsAndAnswers(data) {
            const container = document.getElementById('questionsAndAnswers');
            container.innerHTML = '';

            data.forEach((qa, qIndex) => {
                const qaElement = document.createElement('div');
                qaElement.className = 'question';

                const contentElement = document.createElement('span');
                contentElement.innerHTML = linkify(qa.content);

                const editOptions = document.createElement('div');
                editOptions.className = 'edit-options';
                const editButton = document.createElement('button');
                editButton.innerHTML = '<i class="fas fa-edit"></i>';
                editButton.onclick = () => editQuestion(qIndex);
                const deleteButton = document.createElement('button');
                deleteButton.innerHTML = '<i class="fas fa-trash-alt"></i>';
                deleteButton.onclick = () => deleteQuestion(qIndex);
                editOptions.appendChild(editButton);
                editOptions.appendChild(deleteButton);

                qaElement.appendChild(contentElement);
                qaElement.appendChild(editOptions);

                const inputContainer = document.createElement('div');
                inputContainer.className = 'input-container';

                const textarea = document.createElement('textarea');
                textarea.id = `newAnswer${qIndex}`;
                textarea.value = '';
                textarea.placeholder = 'Type your answer...';

                const submitButton = document.createElement('button');
                submitButton.innerText = 'Answer';
                submitButton.onclick = () => submitAnswer(qIndex);

                inputContainer.appendChild(textarea);
                inputContainer.appendChild(submitButton);

                qaElement.appendChild(inputContainer);

                if (qa.answers.length > 0) {
                    const answersContainer = document.createElement('div');
                    answersContainer.className = 'answers-container';

                    qa.answers.forEach((answer, aIndex) => {
                        const answerElement = document.createElement('div');
                        answerElement.className = 'answer';

                        const subContentElement = document.createElement('span');
                        subContentElement.innerHTML = linkify(answer.content);

                        const subEditOptions = document.createElement('div');
                        subEditOptions.className = 'edit-options';
                        const subEditButton = document.createElement('button');
                        subEditButton.innerHTML = '<i class="fas fa-edit"></i>';
                        subEditButton.onclick = () => editAnswer(qIndex, aIndex);
                        const subDeleteButton = document.createElement('button');
                        subDeleteButton.innerHTML = '<i class="fas fa-trash-alt"></i>';
                        subDeleteButton.onclick = () => deleteAnswer(qIndex, aIndex);
                        subEditOptions.appendChild(subEditButton);
                        subEditOptions.appendChild(subDeleteButton);

                        answerElement.appendChild(subContentElement);
                        answerElement.appendChild(subEditOptions);

                        const subInputContainer = document.createElement('div');
                        subInputContainer.className = 'input-container';

                        const subTextarea = document.createElement('textarea');
                        subTextarea.id = `newReply${qIndex}_${aIndex}`;
                        subTextarea.value = '';
                        subTextarea.placeholder = 'Type your reply...';

                        const subSubmitButton = document.createElement('button');
                        subSubmitButton.innerText = 'Reply';
                        subSubmitButton.onclick = () => submitReply(qIndex, aIndex);

                        subInputContainer.appendChild(subTextarea);
                        subInputContainer.appendChild(subSubmitButton);

                        answerElement.appendChild(subInputContainer);

                        if (answer.replies.length > 0) {
                            const repliesContainer = document.createElement('div');
                            repliesContainer.className = 'replies-container';

                            answer.replies.forEach((reply, rIndex) => {
                                const replyElement = document.createElement('div');
                                replyElement.className = 'reply';

                                const subReplyContentElement = document.createElement('span');
                                subReplyContentElement.innerHTML = `Reply ${rIndex + 1} - ${linkify(reply.content)}`;

                                const subReplyEditOptions = document.createElement('div');
                                subReplyEditOptions.className = 'edit-options';
                                const subReplyEditButton = document.createElement('button');
                                subReplyEditButton.innerHTML = '<i class="fas fa-edit"></i>';
                                subReplyEditButton.onclick = () => editReply(qIndex, aIndex, rIndex);
                                const subReplyDeleteButton = document.createElement('button');
                                subReplyDeleteButton.innerHTML = '<i class="fas fa-trash-alt"></i>';
                                subReplyDeleteButton.onclick = () => deleteReply(qIndex, aIndex, rIndex);
                                subReplyEditOptions.appendChild(subReplyEditButton);
                                subReplyEditOptions.appendChild(subReplyDeleteButton);

                                replyElement.appendChild(subReplyContentElement);
                                replyElement.appendChild(subReplyEditOptions);

                                repliesContainer.appendChild(replyElement);
                            });

                            answerElement.appendChild(repliesContainer);
                        }

                        answersContainer.appendChild(answerElement);
                    });

                    qaElement.appendChild(answersContainer);
                }

                container.appendChild(qaElement);
            });
        }

        function linkify(inputText) {
            const urlRegex = /(https?:\/\/[^\s]+)/g;
            return inputText.replace(urlRegex, url => `<a href="${url}" target="_blank" class="url-preview">${url}</a>`);
        }

        fetchData();
    </script>
</body>
  </html>
  
