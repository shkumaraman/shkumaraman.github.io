<div id="pwa-install-bar" 
     style="display:none; position:fixed; top:0; left:0; width:100%; z-index:10000;
            background:red; color:white; padding:6px 14px;
            display:flex; align-items:center; justify-content:space-between; font-size:14px;">

  <span style="font-weight:600;">Install TalkRush</span>

  <div style="display:flex; align-items:center; gap:8px;">
    <button id="installBtn" 
            style="background:#ffffff; color:#121212; border:none; padding:4px 10px; 
                   border-radius:4px; font-weight:600; cursor:pointer; font-size:13px;">
      Install
    </button>
    <button id="closeInstallBar" 
            style="background:transparent; color:white; border:none; font-size:18px; cursor:pointer; line-height:1;">
      ×
    </button>
  </div>
</div>

<script>
let deferredPrompt;

document.addEventListener("DOMContentLoaded", () => {
  const bar = document.getElementById("pwa-install-bar");
  const installBtn = document.getElementById("installBtn");
  const closeBtn = document.getElementById("closeInstallBar");

  // Close button always works
  closeBtn.addEventListener("click", () => {
    bar.style.display = "none";
  });

  // Install prompt event
  window.addEventListener("beforeinstallprompt", (e) => {
    e.preventDefault();
    deferredPrompt = e;
    bar.style.display = "flex";

    installBtn.onclick = () => {
      bar.style.display = "none";
      deferredPrompt.prompt();
      deferredPrompt.userChoice.then((choiceResult) => {
        if (choiceResult.outcome === "accepted") {
          console.log("User accepted the install ✅");
        } else {
          console.log("User dismissed the install ❌");
        }
        deferredPrompt = null;
      });
    };
  });

  // After installation, bar should hide
  window.addEventListener("appinstalled", () => {
    bar.style.display = "none";
    console.log("PWA installed successfully 🎉");
  });
});
</script>
