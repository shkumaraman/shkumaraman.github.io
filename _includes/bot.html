<script>
class ChatBot {
    constructor(peerId, sendMessageCallback, username = "Stranger") {
        this.peerId = peerId;
        this.sendMessageCallback = sendMessageCallback;
        this.username = username;
        this.isActive = false;
        this.isConnected = false;

        this.messages = [
            "Hi",
            "Hello",
            "Namaste",
            "Hlo",
            "hiiiiiiiii",
            "Hey",
            "Hi there",
            "Hello!",
            "Hlo!",
            "Hey there"
        ];
    }

    activate() {
        this.isActive = true;
    }

    deactivate() {
        this.isActive = false;
    }

    setConnected(connected) {
        this.isConnected = connected;
    }

    sendGreeting() {
        if (!this.isActive || !this.isConnected) {
            return false;
        }

        const randomIndex = Math.floor(Math.random() * this.messages.length);
        const message = this.messages[randomIndex];

        setTimeout(() => {
            if (this.isActive && this.isConnected) {
                this.sendMessageCallback({ type: "typing" });

                setTimeout(() => {
                    if (this.isActive && this.isConnected) {
                        this.sendMessageCallback(message);
                        this.isActive = false;
                    }
                }, 1000 + Math.random() * 1000);
            }
        }, 500 + Math.random() * 1000);

        return true;
    }

    handleMessage(message) {
        return false;
    }
}
</script>
